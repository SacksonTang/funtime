<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.rzyou.funtime.mapper.FuntimeDdzMapper">

    <select id="getRankList" resultType="java.util.Map">
        SELECT
        l.user_id as userId,
        sum( amount ) total,
        u.nickname,
        u.portrait_address as portraitAddress,
        u.show_id as showId
        FROM
            t_funtime_user_account_gold_log l
            INNER JOIN t_funtime_user u ON l.user_id = u.id
        WHERE
            l.operation_type IN ( 'DDZ_GOLD_IN', 'DDZ_GOLD_OUT' )
            and l.create_time between #{startDate} and #{endDate}
        GROUP BY
            l.user_id
        ORDER BY
            total DESC
        limit ${counts}
    </select>

    <insert id="insertDdzRecord" parameterType="com.rzyou.funtime.entity.FuntimeDdz" useGeneratedKeys="true" keyProperty="id">
        insert into t_funtime_ddz_record (user1,gold1,user2,gold2,user3,gold3)
        values (#{user1},#{gold1},#{user2},#{gold2},#{user3},#{gold3})
    </insert>

</mapper>